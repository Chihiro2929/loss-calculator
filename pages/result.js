import { useState, useEffect } from 'react';
import { useRouter } from 'next/router';

export default function Result() {
  const router = useRouter();
  const [loss, setLoss] = useState(null);
  const [continuousLoss, setContinuousLoss] = useState(null); // ç¶™ç¶šæå¤±

  useEffect(() => {
    if (router.isReady) {
      console.log("ğŸš€ Received Loss from query:", router.query.loss);

      const parsedLoss = router.query.loss ? Number(router.query.loss.replace(/,/g, '')) : 0;
      setLoss(parsedLoss);
      setContinuousLoss(Math.round(parsedLoss * 0.24)); // 24% ã®ç¶™ç¶šæå¤±ã‚’è¨ˆç®—
    }
  }, [router.isReady]);

  return (
    <div className="p-12 max-w-6xl mx-auto bg-white rounded-lg shadow-md text-center">
      {/* **ã‚¿ã‚¤ãƒˆãƒ«** */}
      <h1 className="text-3xl font-extrabold mb-8 text-gray-800 bg-gray-200 py-4 shadow-md rounded-lg">
         å›ç·šåœæ­¢ã®ãƒªã‚¹ã‚¯è©¦ç®—çµæœ
      </h1>

      {/* **æå¤±é‡‘é¡ã®è¡¨ç¤º** */}
      <p className="text-lg font-bold text-gray-600">6æ™‚é–“åœæ­¢ã®å ´åˆæƒ³å®šã•ã‚Œã‚‹æå¤±é‡‘é¡</p>
      <p className="text-5xl font-extrabold text-red-600">
        {loss !== null ? `${loss.toLocaleString()} å††` : "è¨ˆç®—ä¸­..."}
      </p>

      {/* **ç¶™ç¶šæå¤±ã®è¡¨ç¤ºï¼ˆè¿½åŠ ï¼‰** */}
      <p className="mt-4 text-lg font-bold text-gray-600">ãã®å¾Œã®ä¼æ¥­ä¿¡ç”¨ä½ä¸‹ã«ãŠã‘ã‚‹ç¶™ç¶šæå¤±ï¼ˆ1ã‚«æœˆã‚ãŸã‚Šï¼‰</p>
      <p className="text-4xl font-extrabold text-orange-600">
        {continuousLoss !== null ? `${continuousLoss.toLocaleString()} å††` : "è¨ˆç®—ä¸­..."}
      </p>

      {/* **ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«ã®è¡¨ç¤º** */}
      <p className="mt-4">
        <span className="bg-yellow-400 text-black text-lg font-bold px-4 py-2 rounded-lg">
          {loss !== null ? `ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ« ${getRiskLevel(loss)}` : ""}
        </span>
      </p>

      {/* **è©¦ç®—çµæœã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæ”¹å–„ç‰ˆï¼‰** */}
      <div className="mt-6 p-6 bg-red-100 border-l-8 border-red-500 rounded-lg shadow-md">
        <p className="text-2xl font-bold text-red-700">
          {loss !== null ? getRiskMessage(loss) : ""}
        </p>
      </div>

      {/* **è£œè¶³èª¬æ˜ï¼ˆè¿½åŠ éƒ¨åˆ†ï¼‰** */}
      <div className="mt-6 p-4 bg-gray-100 border-l-4 border-gray-400 rounded-md shadow-sm text-left">
        <p className="text-lg text-gray-800">
          {loss !== null ? getRiskDetail(loss) : ""}
        </p>
      </div>

      {/* **æ³¨æ„æ›¸ãï¼ˆå‚è€ƒå€¤ã®èª¬æ˜ï¼‰** */}
<p className="text-sm text-gray-500 mt-6">
  â€» ã“ã®è©¦ç®—çµæœã¯ã€æƒ³å®šã•ã‚Œã‚‹æ¡ä»¶ã«åŸºã¥ãæ¦‚ç®—å€¤ã§ã‚ã‚Šã€å®Ÿéš›ã®æå®³é¡ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
</p>

      {/* **ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³** */}
      <div className="mt-10">
        <button
          onClick={() => router.push('/')}
          className="px-8 py-4 bg-blue-500 text-white font-bold rounded-lg shadow-lg hover:bg-blue-700 transition-all text-xl"
        >
          ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
        </button>
      </div>

    </div>

  );
}

// **ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«åˆ¤å®š**
const getRiskLevel = (loss) => {
  if (loss < 50000) return "5";
  if (loss < 300000) return "6";
  if (loss < 800000) return "7";
  if (loss < 1500000) return "8";
  return "9";
};

// **è©¦ç®—çµæœã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**
const getRiskMessage = (loss) => {
  if (loss < 50000) return "âš ï¸ æ²¹æ–­ã¯ç¦ç‰©ï¼å›ç·šãƒˆãƒ©ãƒ–ãƒ«ã¯ã„ã¤ã§ã‚‚èµ·ã“ã‚‹";
  if (loss < 300000) return "âš ï¸ æ¥­å‹™ã®é…å»¶ãƒªã‚¹ã‚¯å¤§ï¼å–å¼•å…ˆã«ã‚‚å½±éŸ¿ãŒåŠã¶å¯èƒ½æ€§";
  if (loss < 800000) return "â›” ç¤¾å†…æ¥­å‹™ã‚¹ãƒˆãƒƒãƒ—ï¼äº‹æ¥­ç¶™ç¶šãŒå›°é›£ãªãƒ¬ãƒ™ãƒ«";
  if (loss < 1500000) return "ğŸš¨ ä¼šç¤¾ã®ä¿¡ç”¨ã«ç›´çµï¼å›ç·šãƒˆãƒ©ãƒ–ãƒ«ãŒçµŒå–¶èª²é¡Œã«";
  return "ğŸ’€ äº‹æ¥­åœæ­¢ãƒ¬ãƒ™ãƒ«ï¼ä¸€åº¦ã®å›ç·šãƒˆãƒ©ãƒ–ãƒ«ãŒè‡´å‘½å‚·ã«";
};

// **è£œè¶³æƒ…å ±ã‚’è¡¨ç¤º**
const getRiskDetail = (loss) => {
  if (loss < 50000) return `
    å›ç·šåœæ­¢ãŒé•·å¼•ãã¨ã€æ¥­å‹™é…å»¶ã‚„é¡§å®¢å¯¾å¿œã®ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ãªãŒã‚Šã€ç¾çŠ¶ã§ã‚‚å¤§ããªæå¤±ã«ç¹‹ãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    ç‰¹ã«ã€ç¤¾å†…ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¾å­˜åº¦ãŒé«˜ã¾ã‚‹ä¸­ã€ä»Šã®ã¾ã¾ã§ã¯ç·Šæ€¥æ™‚ã«è¿…é€Ÿãªå¯¾å¿œãŒã§ããªã„æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚
    ä»Šã®ã†ã¡ã«ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ‰‹æ®µã‚’ç¢ºä¿ã—ã€ç¤¾å†…ã®å¯¾å¿œãƒ•ãƒ­ãƒ¼ã‚’æ˜ç¢ºã«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  `;
  if (loss < 300000) return `
    å›ç·šãŒåœæ­¢ã™ã‚‹ã¨ã€ãƒ¡ãƒ¼ãƒ«ã‚„æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ãŒä½¿ãˆãªããªã‚Šã€ç¤¾å†…æ¥­å‹™ãŒæ»ã‚‹ã ã‘ã§ãªãã€å–å¼•å…ˆã¸ã®å¯¾å¿œã‚‚å¤§ããé…ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    ç‰¹ã«ã€å—ç™ºæ³¨ã‚„æ±ºæ¸ˆãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«ä¾å­˜ã—ã¦ã„ã‚‹å ´åˆã€å¯¾å¿œãŒé…ã‚Œã‚‹ã“ã¨ã§ä¿¡ç”¨å•é¡Œã«ç™ºå±•ã™ã‚‹æã‚Œã‚‚ã‚ã‚Šã¾ã™ã€‚
    æ—©æ€¥ã«ä»£æ›¿æ‰‹æ®µã‚’æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  `;
  if (loss < 800000) return `
    å›ç·šãŒæ­¢ã¾ã‚‹ã¨ã€æ¥­å‹™ã®ã»ã¨ã‚“ã©ãŒæ©Ÿèƒ½ã—ãªããªã‚Šã€å¾“æ¥­å“¡ã®ç”Ÿç”£æ€§ãŒå¤§å¹…ã«ä½ä¸‹ã—ã¾ã™ã€‚
    ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒä½¿ãˆãªããªã‚‹ã“ã¨ã§ã€æ„æ€æ±ºå®šãŒé…ã‚Œã€ä¼šç¤¾å…¨ä½“ã®å‹•ããŒéˆåŒ–ã—ã¾ã™ã€‚
    ã“ã®çŠ¶æ…‹ãŒç¶šãã¨ã€å–å¼•å…ˆã‹ã‚‰ã®ä¿¡ç”¨ã‚’å¤±ã„ã€äº‹æ¥­ç¶™ç¶šè‡ªä½“ãŒå›°é›£ã«ãªã‚‹æã‚Œã‚‚ã€‚
    æ—©æ€¥ã«ä»£æ›¿æ‰‹æ®µã‚’æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  `;
  if (loss < 1500000) return `
    é€šä¿¡ç’°å¢ƒã®ä¸å‚™ãŒåŸå› ã§ã€æ¥­å‹™ã®é…å»¶ã‚„é¡§å®¢å¯¾å¿œã®åœæ­¢ãŒç™ºç”Ÿã€‚
    å¾“æ¥­å“¡ãŒä»•äº‹ã‚’é€²ã‚ã‚‰ã‚Œãªã„ã ã‘ã§ãªãã€é¡§å®¢ãƒ»å–å¼•å…ˆã¸ã®å¯¾å¿œã‚‚æ»ã‚Šã€ä¼šç¤¾ã®ä¿¡ç”¨å•é¡Œã«ç›´çµã—ã¾ã™ã€‚
    ç‰¹ã«ã€æ±ºæ¸ˆã‚„é¡§å®¢æƒ…å ±ç®¡ç†ã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§è¡Œã£ã¦ã„ã‚‹å ´åˆã€é¡§å®¢ã‚¯ãƒ¬ãƒ¼ãƒ ã®ç™ºç”Ÿãƒªã‚¹ã‚¯ãŒå¤§ãããªã‚Šã¾ã™ã€‚
    æ—©æ€¥ã«ä»£æ›¿æ‰‹æ®µã‚’æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  `;
  return `
    ç¾åœ¨ã®æ¥­å‹™ç’°å¢ƒã§ã¯ã€å›ç·šãŒæ­¢ã¾ã‚‹ã¨æ¥­å‹™ãŒå®Œå…¨ã«åœæ­¢ã—ã€å£²ä¸Šã«ã‚‚æ·±åˆ»ãªå½±éŸ¿ãŒå‡ºã‚‹ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚
    ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹æ¥­ç¨®ã¯ã€å–å¼•å…ˆã‚„é¡§å®¢ã«ä¸ãˆã‚‹å½±éŸ¿ãŒè¨ˆã‚ŠçŸ¥ã‚Œã¾ã›ã‚“ã€‚
    å›ç·šåœæ­¢ãŒé•·å¼•ã‘ã°ã€é¡§å®¢é›¢ã‚Œãƒ»å£²ä¸Šæ¸›å°‘ãƒ»ä¼æ¥­ã®ä¿¡é ¼å¤±å¢œã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒé«˜ããªã‚Šã¾ã™ã€‚
    ã€Œå¤§è¦æ¨¡ãªã‚·ã‚¹ãƒ†ãƒ éšœå®³ãŒèµ·ããŸã‚‰ã©ã†ã™ã‚‹ã®ã‹ï¼Ÿã€ä»Šã™ãå¯¾ç­–ã‚’æ¤œè¨ã™ã‚‹ã¹ãã§ã™ã€‚
    æ—©æ€¥ã«ä»£æ›¿æ‰‹æ®µã‚’æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
  `;
};









